<!DOCTYPE html>
<html>

<head>
    <title>{{ .Title }}</title>
</head>

<body>
    <nav>
        {{ range .breadcrumbs }}
        <a href="{{ .URL }}">{{ .Label }}</a>
        {{ if not .IsLast }} / {{ end }}
        {{ end }}
    </nav>
    <h1>{{ upper .Title }}</h1>
    <p>Patient: {{ .visit.Patient.Name }}</p>
    <p>Doctor: {{ .doctor }}</p>
    <h2>Management</h2>
    {{ range .management }}
    <div>{{ .Prescription.Drug.Name }}</div>
    {{ $.Title }}
    {{ end }}

    <h2>Prescriptions</h2>
    {{ range .prescriptions }}
    <div class="prescription">
        {{ $name := .DrugName }}
        <span>{{ $name }}</span>
        <span>{{ .Quantity }}</span>
        <span>{{ .Dosage }}</span>
    </div>
    {{ end }}

    <h2>Billed Drugs</h2>
    {{ range .billedDrugs }}
    {{ template "billed-drug" . }}
    {{ end }}
    <a href="{{ .PathPrefix }}/new">New Entry</a>
    {{ template "views/partials/footer.html" .visit }}
    {{ block "billed-drug" }}
    <div>{{ .Name }}</div>
    {{ end }}

    <!-- Passed through a context-file -->
    {{ $.newuser.Name }}
    {{ $.currentUser }}


    <!-- Pass a Map to a cross-file template -->
    {{ template "roles" .roles }}
    <!-- Same-file block -->

    {{ block "user-msg" .currentUser }}
    <h1>Hello: {{ .Name }}</h1>
    {{ end }}

    {{ template "messages" . }}

    {{ define "messages" }}
    {{ $msg := index .prescriptions 0 }}
    <h1>{{ $msg }}</h1>
    {{ end}}
</body>

</html>